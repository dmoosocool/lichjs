"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _=require("@lich/virtual-dom");function F(t){return t===void 0}function w(t){return t!==void 0}const j=_.vnode("",{},[],void 0,void 0);function M(t,e){var o,n;const i=t.key===e.key,l=((o=t.data)==null?void 0:o.is)===((n=e.data)==null?void 0:n.is);return t.sel===e.sel&&i&&l}function Q(){throw new Error("The document fragment is not supported on this platform.")}function V(t,e){return t.isElement(e)}function tt(t,e){return t.isDocumentFragment(e)}function et(t,e,o){var n;const i={};for(let l=e;l<=o;++l){const f=(n=t[l])==null?void 0:n.key;f!==void 0&&(i[f]=l)}return i}const it=["create","update","remove","destroy","pre","post"];function nt(t,e,o){const n={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},i=e!==void 0?e:_.htmlDomApi;for(const r of it)for(const s of t){const d=s[r];d!==void 0&&n[r].push(d)}function l(r){const s=r.id?"#"+r.id:"",d=r.getAttribute("class"),u=d?"."+d.split(" ").join("."):"";return _.vnode(i.tagName(r).toLowerCase()+s+u,{},[],void 0,r)}function f(r){return _.vnode(void 0,{},[],void 0,r)}function c(r,s){return function(){if(--s===0){const u=i.parentNode(r);i.removeChild(u,r)}}}function a(r,s){var d,u,h,g,x;let m,v=r.data;if(v!==void 0){const S=(d=v.hook)==null?void 0:d.init;w(S)&&(S(r),v=r.data)}const k=r.children,p=r.sel;if(p==="!")F(r.text)&&(r.text=""),r.elm=i.createComment(r.text);else if(p!==void 0){const S=p.indexOf("#"),N=p.indexOf(".",S),L=S>0?S:p.length,E=N>0?N:p.length,C=S!==-1||N!==-1?p.slice(0,Math.min(L,E)):p,P=r.elm=w(v)&&w(m=v.ns)?i.createElementNS(m,C,v):i.createElement(C,v);for(L<E&&P.setAttribute("id",p.slice(L+1,E)),N>0&&P.setAttribute("class",p.slice(E+1).replace(/\./g," ")),m=0;m<n.create.length;++m)n.create[m](j,r);if(k!==void 0&&_.isArray(k))for(m=0;m<k.length;++m){const H=k[m];H!=null&&i.appendChild(P,a(H,s))}else _.isPrimitive(r.text)&&i.appendChild(P,i.createTextNode(r.text||""));const O=(u=r.data)==null?void 0:u.hook;w(O)&&((h=O.create)==null||h.call(O,j,r),O.insert&&s.push(r))}else if(((g=o==null?void 0:o.experimental)==null?void 0:g.fragments)&&r.children){const S=r.children;for(r.elm=((x=i.createDocumentFragment)!=null?x:Q)(),m=0;m<n.create.length;++m)n.create[m](j,r);for(m=0;m<S.length;++m){const N=S[m];N!=null&&i.appendChild(r.elm,a(N,s))}}else r.elm=i.createTextNode(r.text);return r.elm}function y(r,s,d,u,h,g){for(;u<=h;++u){const x=d[u];x!=null&&i.insertBefore(r,a(x,g),s)}}function A(r){var s,d;const u=r.data;if(u!==void 0){(d=(s=u==null?void 0:u.hook)==null?void 0:s.destroy)==null||d.call(s,r);for(let h=0;h<n.destroy.length;++h)n.destroy[h](r);if(r.children!==void 0)for(let h=0;h<r.children.length;++h){const g=r.children[h];g!=null&&typeof g!="string"&&A(g)}}}function b(r,s,d,u){for(var h,g;d<=u;++d){let x,m;const v=s[d];if(v!=null)if(w(v.sel)){A(v),x=n.remove.length+1,m=c(v.elm,x);for(let p=0;p<n.remove.length;++p)n.remove[p](v,m);const k=(g=(h=v==null?void 0:v.data)==null?void 0:h.hook)==null?void 0:g.remove;w(k)?k(v,m):m()}else i.removeChild(r,v.elm)}}function D(r,s,d,u){let h=0,g=0,x=s.length-1,m=s[0],v=s[x],k=d.length-1,p=d[0],S=d[k],N,L,E,C;for(;h<=x&&g<=k;)m==null?m=s[++h]:v==null?v=s[--x]:p==null?p=d[++g]:S==null?S=d[--k]:M(m,p)?(T(m,p,u),m=s[++h],p=d[++g]):M(v,S)?(T(v,S,u),v=s[--x],S=d[--k]):M(m,S)?(T(m,S,u),i.insertBefore(r,m.elm,i.nextSibling(v.elm)),m=s[++h],S=d[--k]):M(v,p)?(T(v,p,u),i.insertBefore(r,v.elm,m.elm),v=s[--x],p=d[++g]):(N===void 0&&(N=et(s,h,x)),L=N[p.key],F(L)?i.insertBefore(r,a(p,u),m.elm):(E=s[L],E.sel!==p.sel?i.insertBefore(r,a(p,u),m.elm):(T(E,p,u),s[L]=void 0,i.insertBefore(r,E.elm,m.elm))),p=d[++g]);g<=k&&(C=d[k+1]==null?null:d[k+1].elm,y(r,C,d,g,k,u)),h<=x&&b(r,s,h,x)}function T(r,s,d){var u,h,g,x,m;const v=(u=s.data)==null?void 0:u.hook;(h=v==null?void 0:v.prepatch)==null||h.call(v,r,s);const k=s.elm=r.elm,p=r.children,S=s.children;if(r!==s){if(s.data!==void 0){for(let N=0;N<n.update.length;++N)n.update[N](r,s);(x=(g=s.data.hook)==null?void 0:g.update)==null||x.call(g,r,s)}F(s.text)?w(p)&&w(S)?p!==S&&D(k,p,S,d):w(S)?(w(r.text)&&i.setTextContent(k,""),y(k,null,S,0,S.length-1,d)):w(p)?b(k,p,0,p.length-1):w(r.text)&&i.setTextContent(k,""):r.text!==s.text&&(w(p)&&b(k,p,0,p.length-1),i.setTextContent(k,s.text)),(m=v==null?void 0:v.postpatch)==null||m.call(v,r,s)}}return function(s,d){let u,h,g;const x=[];for(u=0;u<n.pre.length;++u)n.pre[u]();for(V(i,s)?s=l(s):tt(i,s)&&(s=f(s)),M(s,d)?T(s,d,x):(h=s.elm,g=i.parentNode(h),a(d,x),g!==null&&(i.insertBefore(g,d.elm,i.nextSibling(h)),b(g,[s],0,0))),u=0;u<x.length;++u)x[u].data.hook.insert(x[u]);for(u=0;u<n.post.length;++u)n.post[u]();return d}}function lt(t,e,o,n,i){const l=e===void 0?void 0:e.key;return{sel:t,data:e,children:o,text:n,elm:i,key:l}}const ot={createElement:function(t,e){return document.createElement(t,e)},createElementNS:function(t,e,o){return document.createElementNS(t,e,o)},createDocumentFragment:function(){return document.createDocumentFragment()},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){throw document.createComment(t)},insertBefore:function(t,e,o){t.insertBefore(e,o)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return t.nodeType===1},isText:function(t){return t.nodeType===3},isComment:function(t){return t.nodeType===8},isDocumentFragment:function(t){return t.nodeType===11}};function R(t,e,o){if(t.ns="http://www.w3.org/2000/svg",o!=="foreignObject"&&e!==void 0)for(let n=0;n<e.length;++n){const i=e[n].data;i!==void 0&&R(i,e[n].children,e[n].sel)}}function rt(t,e,o){let n={},i,l,f;if(o!==void 0?(e!==null&&(n=e),_.isArray(o)?i=o:_.isPrimitive(o)?l=o.toString():o&&o.sel&&(i=[o])):e!=null&&(_.isArray(e)?i=e:_.isPrimitive(e)?l=e.toString():e&&e.sel?i=[e]:n=e),i!==void 0)for(f=0;f<i.length;++f)_.isPrimitive(i[f])&&(i[f]=_.vnode(void 0,void 0,void 0,i[f],void 0));return t[0]==="s"&&t[1]==="v"&&t[2]==="g"&&(t.length===3||t[3]==="."||t[3]==="#")&&R(n,i,t),_.vnode(t,n,i,l,void 0)}function st(t){let e,o;if(_.isArray(t)?e=t:_.isPrimitive(e)?o=t:e&&e.sel&&(e=[t]),e!==void 0)for(let n=0;n<e.length;++n)_.isPrimitive(e[n])&&(e[n]=_.vnode(void 0,void 0,void 0,e[n],void 0));return _.vnode(void 0,{},e,o,void 0)}const at=Array.isArray;function ct(t){return typeof t=="string"||typeof t=="number"||t instanceof String||t instanceof Number}function ft(t,e){e.data===void 0&&(e.data={}),e.data.hook===void 0&&(e.data.hook={});const o=e.data;return e.data.hook,o.attachData={target:t,placeholder:void 0,real:void 0},e}function K(t){const e=[];for(let o=0;o<t.length;o++)e.push(t[o]);return e}function q(t,e){const o=e!==void 0?e:_.htmlDomApi;let n;if(o.isElement(t)){const i=t.id?"#"+t.id:"",l=t.getAttribute("class"),f=l?"."+l.split(" ").join("."):"",c=o.tagName(t).toLowerCase()+i+f,a={},y=[];let A,b,D;const T=t.attributes,r=t.childNodes,s={};for(K(T).forEach(u=>{u.name.startsWith("data-")&&(s[u.name.replace("data-","")]=u.value)}),K(T).forEach(u=>{Object.keys(s).includes(u.name.replace("data-",""))&&T.removeNamedItem(u.name)}),b=0,D=T.length;b<D;b++)A=T[b].nodeName,A!=="id"&&A!=="class"&&(a[A]=T[b].nodeValue);for(b=0,D=r.length;b<D;b++)y.push(q(r[b],e));const d={};return Object.keys(a).length&&(d.attrs=a),Object.keys(s).length&&(d.datasets=s),_.vnode(c,d,y,void 0,t)}else return o.isText(t)?(n=o.getTextContent(t),_.vnode(void 0,void 0,void 0,n,t)):o.isComment(t)?(n=o.getTextContent(t),_.vnode("!",{},[],n,t)):_.vnode("",{},[],void 0,t)}const ut="http://www.w3.org/1999/xlink",dt="http://www.w3.org/XML/1998/namespace",X=58,mt=120;function $(t,e){var o,n;let i;const l=e.elm;let f=(o=t.data)==null?void 0:o.attrs,c=(n=e.data)==null?void 0:n.attrs;if(!(!f&&!c)&&f!==c){f=f||{},c=c||{};for(i in c){const a=c[i];f[i]!==a&&(a===!0?l.setAttribute(i,""):a===!1?l.removeAttribute(i):i.charCodeAt(0)!==mt?l.setAttribute(i,a.toString()):i.charCodeAt(3)===X?l.setAttributeNS(dt,i,a.toString()):i.charCodeAt(5)===X?l.setAttributeNS(ut,i,a.toString()):l.setAttribute(i,a.toString()))}for(i in f)i in c||l.removeAttribute(i)}}const pt={create:$,update:$};function G(t,e){var o,n;let i,l;const f=e.elm;let c=(o=t.data)==null?void 0:o.class,a=(n=e.data)==null?void 0:n.class;if(!(!c&&!a)&&c!==a){c=c||{},a=a||{};for(l in c)c[l]&&!Object.prototype.hasOwnProperty.call(a,l)&&f.classList.remove(l);for(l in a)i=a[l],i!==c[l]&&f.classList[i?"add":"remove"](l)}}const vt={create:G,update:G},U=/[A-Z]/g;function W(t,e){var o,n;const i=e.elm;let l=(o=t.data)==null?void 0:o.dataset,f=(n=e.data)==null?void 0:n.dataset,c;if(!l&&!f||l===f)return;l=l||{},f=f||{};const a=i.dataset;for(c in l)f[c]||(a?c in a&&delete a[c]:i.removeAttribute("data-"+c.replace(U,"-$&").toLowerCase()));for(c in f)l[c]!==f[c]&&(a?a[c]=f[c]:i.setAttribute("data-"+c.replace(U,"-$&").toLowerCase(),f[c]))}const ht={create:W,update:W};function Z(t,e,o){if(typeof t=="function")t.call(e,o,e);else if(typeof t=="object")for(let n=0;n<t.length;n++)Z(t[n],e,o)}function yt(t,e){var o;const n=t.type,i=(o=e.data)==null?void 0:o.on;i&&i[n]&&Z(i[n],e,t)}function gt(){return function t(e){yt(e,t.vnode)}}function B(t,e){var o,n;const i=(o=t.data)==null?void 0:o.on,l=t.listener,f=t.elm,c=e&&((n=e.data)==null?void 0:n.on),a=e&&e.elm;let y;if(i!==c){if(i&&l)if(c)for(y in i)c[y]||f.removeEventListener(y,l,!1);else for(y in i)f.removeEventListener(y,l,!1);if(c){const A=e.listener=t.listener||gt();if(A.vnode=e,i)for(y in c)i[y]||a.addEventListener(y,A,!1);else for(y in c)a.addEventListener(y,A,!1)}}}const xt={create:B,update:B,destroy:B};function z(t,e){var o,n;let i,l,f;const c=e.elm;let a=(o=t.data)==null?void 0:o.props,y=(n=e.data)==null?void 0:n.props;if(!(!a&&!y)&&a!==y){a=a||{},y=y||{};for(i in y)l=y[i],f=a[i],f!==l&&(i!=="value"||c[i]!==l)&&(c[i]=l)}}const St={create:z,update:z},J=typeof window!="undefined"&&window.requestAnimationFrame.bind(window)||setTimeout,kt=function(t){J(function(){J(t)})};let I=!1;function _t(t,e,o){kt(function(){t[e]=o})}function Y(t,e){var o,n;let i,l;const f=e.elm;let c=(o=t.data)==null?void 0:o.style,a=(n=e.data)==null?void 0:n.style;if(!c&&!a||c===a)return;c=c||{},a=a||{};const y="delayed"in c;for(l in c)a[l]||(l[0]==="-"&&l[1]==="-"?f.style.removeProperty(l):f.style[l]="");for(l in a)if(i=a[l],l==="delayed"&&a.delayed)for(const A in a.delayed)i=a.delayed[A],(!y||i!==c.delayed[A])&&_t(f.style,A,i);else l!=="remove"&&i!==c[l]&&(l[0]==="-"&&l[1]==="-"?f.style.setProperty(l,i):f.style[l]=i)}function bt(t){var e;let o,n;const i=t.elm,l=(e=t.data)==null?void 0:e.style;if(!(!l||!(o=l.destroy)))for(n in o)i.style[n]=o[n]}function At(t,e){var o;const n=(o=t.data)==null?void 0:o.style;if(!n||!n.remove){e();return}if(t.elm){I||(t.elm.offsetLeft,I=!0);let i;const l=t.elm;let f=0;const c=n.remove;let a=0;const y=[];for(i in c)y.push(i),l.style[i]=c[i];const b=getComputedStyle(l).transitionProperty.split(", ");for(;f<b.length;++f)y.indexOf(b[f])!==-1&&a++;l.addEventListener("transitionend",D=>{D.target===l&&--a,a===0&&e()})}}function Nt(){I=!1}const Tt={pre:Nt,create:Y,update:Y,destroy:bt,remove:At};exports.attachTo=ft,exports.attributesModule=pt,exports.classModule=vt,exports.datasetModule=ht,exports.eventListenersModule=xt,exports.fragment=st,exports.h=rt,exports.htmlDomApi=ot,exports.init=nt,exports.isArray=at,exports.isPrimitive=ct,exports.propsModule=St,exports.styleModule=Tt,exports.toVNode=q,exports.vnode=lt;
